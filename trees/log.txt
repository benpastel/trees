TREE_COUNT=100


Agaricus:

X.shape: train (5211, 126), valid (1302, 126)
binary classification with 2518 true and 2693 false
train xgboost with: {'n_estimators': 100, 'tree_method': 'hist'}...
(0.1s)
predict xgboost...
(0.0s)

      train preds bincount: [2693 2518]
      train: accuracy = 100.00%, precision = 100.00%, recall = 100.00%
      valid: accuracy = 100.00%, precision = 100.00%, recall = 100.00%

train our tree with Params(smooth_factor=100.0, max_nodes=3280, max_depth=8, tree_count=100, learning_rate=0.3, third_split_penalty=4.0, bucket_count=64, bucket_sample_count=10000, trees_per_bucketing=2)...
(2.3s)
Classification model with 26 trees with sizes min=1 max=40 mean=27.076923076923077
predict our tree...
(0.0s)

      train preds bincount: [2693 2518]
      train: accuracy = 100.00%, precision = 100.00%, recall = 100.00%
      valid: accuracy = 100.00%, precision = 100.00%, recall = 100.00%



House Prices:

X.shape: train (1168, 79), valid (292, 79)
regression targets with min=35311.0, max=755000.0, mean=181216.2
train xgboost with: {'n_estimators': 100, 'tree_method': 'hist'}...
(0.1s)
predict xgboost...
(0.0s)

      train: log(MSE): 13.97, MAE: 752.35
      valid: log(MSE): 20.21, MAE: 16691.15

train our tree with Params(smooth_factor=100.0, max_nodes=3280, max_depth=8, tree_count=100, learning_rate=0.3, third_split_penalty=4.0, bucket_count=64, bucket_sample_count=10000, trees_per_bucketing=2)...
(0.6s)
Regression model with 11 trees with sizes min=1 max=10 mean=6.181818181818182
predict our tree...
(0.0s)

      train: log(MSE): 20.89, MAE: 23049.75
      valid: log(MSE): 20.78, MAE: 22831.97



Home Credit Default:

X.shape: train (246009, 104), valid (61502, 104)
binary classification with 19842 true and 226167 false
train xgboost with: {'n_estimators': 100, 'tree_method': 'hist'}...
(2.7s)
predict xgboost...
(0.6s)

      train preds bincount: [244702   1307]
      train: accuracy = 92.26%, precision = 80.64%, recall = 5.31%
      valid: accuracy = 91.90%, precision = 49.80%, recall = 2.53%

train our tree with Params(smooth_factor=100.0, max_nodes=3280, max_depth=8, tree_count=100, learning_rate=0.3, third_split_penalty=4.0, bucket_count=64, bucket_sample_count=10000, trees_per_bucketing=2)...
(1.9s)
Classification model with 13 trees with sizes min=1 max=52 mean=21.53846153846154
predict our tree...
(0.1s)

      train preds bincount: [246009]
      train: accuracy = 91.93%, precision = 0.00%, recall = 0.00%
      valid: accuracy = 91.90%, precision = 0.00%, recall = 0.00%



Santander Value:

X.shape: train (3568, 4991), valid (891, 4991)
regression targets with min=30000.0, max=40000000.0, mean=5951684.1
train xgboost with: {'n_estimators': 100, 'tree_method': 'hist'}...
(8.4s)
predict xgboost...
(0.3s)

      train: log(MSE): 29.97, MAE: 2214584.97
      valid: log(MSE): 31.75, MAE: 5184175.40

train our tree with Params(smooth_factor=100.0, max_nodes=3280, max_depth=8, tree_count=100, learning_rate=0.3, third_split_penalty=4.0, bucket_count=64, bucket_sample_count=10000, trees_per_bucketing=2)...
(8.8s)
Regression model with 7 trees with sizes min=1 max=7 mean=4.0
predict our tree...
(0.0s)

      train: log(MSE): 31.65, MAE: 5370477.07
      valid: log(MSE): 31.69, MAE: 5437188.30



M5:

loading from cache
X.shape: train (37734424, 19), valid (9433606, 19)
regression targets with min=0.0, max=763.0, mean=1.2
train xgboost with: {'n_estimators': 100, 'tree_method': 'hist'}...
(109.9s)
predict xgboost...
(22.9s)

      train: MSE: 4.44, MAE: 0.83
      valid: MSE: 4.46, MAE: 0.83

train our tree with Params(smooth_factor=100.0, max_nodes=3280, max_depth=8, tree_count=100, learning_rate=0.3, third_split_penalty=4.0, bucket_count=64, bucket_sample_count=10000, trees_per_bucketing=2)...
(46.5s)
Regression model with 25 trees with sizes min=1 max=3280 mean=1855.0
predict our tree...
(7.5s)

      train: MSE: 3.77, MAE: 0.82
      valid: MSE: 4.44, MAE: 0.83



Grupo:

loading from cache
X.shape: train (33112214, 75), valid (8278053, 75)
regression targets with min=0.0, max=5000.0, mean=7.3
train xgboost with: {'n_estimators': 100, 'tree_method': 'hist'}...
(238.2s)
predict xgboost...
(56.2s)

      train: MSE: 134.47, MAE: 3.67
      valid: MSE: 156.36, MAE: 3.69

train our tree with Params(smooth_factor=100.0, max_nodes=3280, max_depth=8, tree_count=100, learning_rate=0.3, third_split_penalty=4.0, bucket_count=64, bucket_sample_count=10000, trees_per_bucketing=2)...
(242.9s)
Regression model with 41 trees with sizes min=1 max=3280 mean=2037.7073170731708
predict our tree...
(22.3s)

      train: MSE: 78.73, MAE: 3.42
      valid: MSE: 143.18, MAE: 3.53